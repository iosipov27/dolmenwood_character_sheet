{"version":3,"file":"normalizeDwFlags.js","sourceRoot":"","sources":["../../src/utils/normalizeDwFlags.ts"],"names":[],"mappings":"AAEA,MAAM,UAAU,gBAAgB,CAAC,EAAgB;IAC7C,4EAA4E;IAC5E,MAAM,CAAC,GAAG,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,CAAiB,CAAC;IAC5D,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE,CAA+C,CAAC;IAE5E,IAAI,OAAO,KAAK,CAAC,KAAK,KAAK,QAAQ;QAAE,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC;IAE5E,IAAI,KAAK,CAAC,UAAU,IAAI,IAAI,EAAE,CAAC;QAC3B,MAAM,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,UAAU,IAAI,CAAC,CAAC,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,KAAK,CAAC;YAAE,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC;QACzD,OAAO,KAAK,CAAC,UAAU,CAAC;IAC5B,CAAC;IAED,CAAC,CAAC,KAAK,GAAG,KAAgB,CAAC;IAC3B,OAAO,CAAY,CAAC;AACxB,CAAC","sourcesContent":["import type { DwFlags, DwFlagsInput, DwSaves } from \"../types.js\";\n\nexport function normalizeDwFlags(dw: DwFlagsInput): DwFlags {\n    // If an old \"resistance\" existed, fold it into magic (prefer magic if set).\n    const d = foundry.utils.duplicate(dw ?? {}) as DwFlagsInput;\n    const saves = (d.saves ?? {}) as Partial<DwSaves> & { resistance?: number };\n\n    if (typeof saves.magic !== \"number\") saves.magic = Number(saves.magic ?? 0);\n\n    if (saves.resistance != null) {\n        const res = Number(saves.resistance ?? 0);\n        if (!saves.magic || saves.magic === 0) saves.magic = res;\n        delete saves.resistance;\n    }\n\n    d.saves = saves as DwSaves;\n    return d as DwFlags;\n}\n"]}