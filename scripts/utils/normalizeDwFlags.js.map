{"version":3,"file":"normalizeDwFlags.js","sourceRoot":"","sources":["../../src/utils/normalizeDwFlags.ts"],"names":[],"mappings":"AAEA,MAAM,UAAU,gBAAgB,CAAC,EAAgB;IAC/C,4EAA4E;IAC5E,MAAM,CAAC,GAAG,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,CAAiB,CAAC;IAC5D,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE,CAA+C,CAAC;IAE5E,IAAI,OAAO,KAAK,CAAC,KAAK,KAAK,QAAQ;QAAE,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC;IAE5E,IAAI,KAAK,CAAC,UAAU,IAAI,IAAI,EAAE,CAAC;QAC7B,MAAM,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,UAAU,IAAI,CAAC,CAAC,CAAC;QAE1C,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,KAAK,CAAC;YAAE,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC;QACzD,OAAO,KAAK,CAAC,UAAU,CAAC;IAC1B,CAAC;IAED,CAAC,CAAC,KAAK,GAAG,KAAgB,CAAC;IAE3B,OAAO,CAAY,CAAC;AACtB,CAAC","sourcesContent":["import type { DwFlags, DwFlagsInput, DwSaves } from \"../types.js\";\r\n\r\nexport function normalizeDwFlags(dw: DwFlagsInput): DwFlags {\r\n  // If an old \"resistance\" existed, fold it into magic (prefer magic if set).\r\n  const d = foundry.utils.duplicate(dw ?? {}) as DwFlagsInput;\r\n  const saves = (d.saves ?? {}) as Partial<DwSaves> & { resistance?: number };\r\n\r\n  if (typeof saves.magic !== \"number\") saves.magic = Number(saves.magic ?? 0);\r\n\r\n  if (saves.resistance != null) {\r\n    const res = Number(saves.resistance ?? 0);\r\n\r\n    if (!saves.magic || saves.magic === 0) saves.magic = res;\r\n    delete saves.resistance;\r\n  }\r\n\r\n  d.saves = saves as DwSaves;\r\n\r\n  return d as DwFlags;\r\n}\r\n"]}